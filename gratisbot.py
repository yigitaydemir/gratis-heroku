import tweepy
import random
import time

followers = [1478685689667796995, 1360326627180351490, 1482218959516712969, 1468897679606525958, 237838115, 1454937247157993474, 1464389724886417415, 1425636865508528128, 859070837500112896, 1319638501302980614, 326492758, 1452532575667245063, 1426268491850522626, 1383636826179575815, 1479642615276470274, 1475760647854075904, 1480394016101384201, 1609689422, 1437733495443394562, 1479656990444244994, 1449625455657631747, 897820260, 1429972306328231939, 4519383254, 1452479428135510021, 936150112425742336, 1165152606634643456, 2443927602, 156619222, 1479011928315809795, 1472085975228907520, 1111642967595511808, 1429859315620491268, 1343433941173239808, 712620433531535360, 321397641, 1478094978161131520, 802120562759888896, 1375864339387846665, 1478382674968555523, 1395279555737182208, 1478337980859392001, 1441100880795762696, 1475658718444404743, 1459046536315297818, 1360619829313630209, 1358248226495807493, 1476436717796167680, 636233256, 1448252520560660484, 1448225914622337024, 861769458079150080, 1035770935750656000, 2346183709, 1226587972419518464, 1087178612359327744, 794561722623422464, 1469103997873238027, 1254428292356153346, 1467062801197776896, 1453163760793767939, 1463987501559910405, 1464651667253694464, 1473268404165431333, 1449054807101169664, 1457502828453371904, 1385905812854513665, 1197184322429542402, 836914431758065665, 1467926997414391813, 1471547680736387075, 1463696565508325378, 1471508367260585993, 1397075897132400640, 2713666201, 1470772799342006291, 251431465, 1464648938485657609, 1465554073407692805, 3042303047, 1454286207194566661, 1356195553952980992, 2382885698, 1393694312278462467, 1177113088618713088, 1390964382260031488, 1445744420452585480, 1069168679772921856, 1399271253538533384, 328501836, 1440663044497887239, 1444628080358825988, 851335394759065601, 978726080872927232, 2259913924, 1352077983301971969, 1464610140087275520, 1448010620171796486, 1448565531620093953, 1618515242, 278289191, 1419398298809556992, 2587806853, 783281371259215872, 1468976064378679296, 3051753253, 1173483376856027136, 1328435385920331778, 1470385010121322497, 1423764841513177096, 1458097899099852806, 1470166086662463489, 1468295918378176516, 447080674, 1392244579995377667, 1392421276749336580, 1391189063873581057]

API_KEY = "xLNZsUv83kvD14m1Nw8ixs4no"
SECRET_KEY = "JEkDQ3Tq7P4uPtuBPg04qjEXzYCdu0cygblMHEJAgJS44Sp0nY"
BEARER_TOKEN = 'AAAAAAAAAAAAAAAAAAAAAIuncQEAAAAAG0OUblfiy8neyzGTZtjOv7zu2YY%3DjeUTVCQg8OiNXgAfiyTNfCiNVf3y7R0YRmhwyrinph6mFnGZCS'
ACCESS_TOKEN = "1470232021284892678-voFt1EyWyymieHzivhWqlpRrTRp8yo"
SECRET_TOKEN = "HMnZCCTmPf6GuTjehjDKBhxupglkVVCU2ltf6HRBe8L8a"

client = tweepy.Client(consumer_key=API_KEY,
                       consumer_secret=SECRET_KEY,
                       access_token=ACCESS_TOKEN,
                       access_token_secret=SECRET_TOKEN,
                       bearer_token=BEARER_TOKEN,wait_on_rate_limit=True)


def tags():
    my_tags = random.choices(followers, k=3)
    #
    a = client.get_user(id=my_tags[0])
    a = str(a).split("username=")[1].split(">")[0]
    a = "@" + a
    b = client.get_user(id=my_tags[1])
    b = str(b).split("username=")[1].split(">")[0]
    b = "@" + b
    c = client.get_user(id=my_tags[2])
    c = str(c).split("username=")[1].split(">")[0]
    c = "@" + c
    print(a,b,c)
    return (a, b, c)

liste = ["sol", "eth"]
for i in liste:
    if i == "sol":
        adress = "5kG2KyFfCB3ythy8199eFAh21yMftBBc5N7giDJW2e5a"
    elif i == "eth":
        adress = "0x502aC0852e10De0a5EDa511fb547a86c30Ff49Ac"

    query = f'NFT giveaway {i} -is:retweet -is:reply'
    tweets = client.search_recent_tweets(query = query, max_results=10, tweet_fields=["author_id"])
    counter = 0
    mytags = tags()
    a,b,c = mytags
    for tweet in tweets[0]:
        
        #print(tweet.id, tweet.author_id, tweet.text, end="\n\n************\n\n",sep="\n")
        if counter == 0:
            tag = a + " " + b + " " + c + " " + adress
            client.like(tweet.id)
            client.create_tweet(text = tag, in_reply_to_tweet_id=tweet.id)
            client.follow_user(tweet.author_id)
            client.retweet(tweet.id)
            counter += 1
            time.sleep(10)